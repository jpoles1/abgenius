<template>
	<div>
		<svg :width="width + xMargin * 2" :height="height">
			<g :transform="'translate(' + xMargin + ', 0)'">
				<clipPath id="cut-off">
					<path
						:transform="'scale(' + width / 526 + ', ' + height / 440 + ')'"
						d="M372.787 70.843l-.235.028-.016-1.251.251 1.223zm.993 4.841l-1.167.127-.031-2.471.702-.075.496 2.419zm.993 4.844l-2.097.225-.031-2.472 1.632-.176.496 2.423zm.498 2.422l.493 2.419-3.026.326-.031-2.47 2.564-.275zm1.49 7.261l-3.962.427-.031-2.471 3.495-.376.498 2.42zm-78.782 25.655l19.378 28.051.149-.012c2.008-.016 4.443-.033 7.237-.053 2.667.128 5.666.247 8.913.463 1.137.111 2.323.208 3.525.31l-.47-.184 16.04-35.47-21.469-43.518-11.351-4.881 8.346 2.467 10.305-18.551-5.865 20.369 8.674 13.318 11.274-20.828-8.315 25.373 13.625 20.926 14.878-8.663-.024-1.874 3.983-.429 21.66-12.612a433.212 433.212 0 00-23.569-20.443c-17.218-13.895-31.264-20.94-41.748-20.94-14.923 0-21.363 14.631-27.676 32.308-2.279 6.377-5.063 22.81-7.5 44.873m131.524 19.074l.194-.348 1.425 1.019-1.619-.671zm-2.29-.946l-2.286-.947.742-1.336 2.014 1.44-.47.843zm-4.574-1.891l-2.289-.947 1.29-2.328 2.015 1.442-1.016 1.833zm-4.576-1.894l-2.29-.948 1.84-3.314 2.014 1.44-1.564 2.822zM398.548 80.14l-39.956 29.334-11.919 36.132c2.85.333 5.773.684 8.785 1.131l-.298-.359 20.718-15.627.232-23.817.599-.376 15.214-9.519-12.623 11.328 3.407 19.28 27.907-2.136 2.573-1.732.397-.714.321.231 11.448-7.71-10.36 8.49.605.43-2.113 3.808-2.289-.945.187-.335-.12.099-.259.043-29.427 5.06-17.307 15.806c1.18.186 2.353.368 3.546.561 4.163.633 8.362 1.437 12.57 2.154a803.935 803.935 0 0121.63 4.258l41.621-12.818-34.351 14.384a730.017 730.017 0 0116.989 3.934 465.22 465.22 0 0114.94 3.922l5.607 1.682-5.71-1.271a462.785 462.785 0 00-15.151-2.827c-9.729-1.651-22.013-3.48-34.889-5.07l8.955 6.217 18.102 12.897-14.775-7.465-3.752 16.336-.629-18.551-1.147-.58a4848.837 4848.837 0 01-21.212-10.493c-3.195-.33-6.376-.667-9.526-.917-4.155-.367-8.241-.714-12.196-.95-3.954-.3-7.771-.45-11.388-.607-3.616-.195-7.017-.145-10.159-.225-3.127.017-5.981.115-8.498.17-.447.035-.872.066-1.297.098l24.805 35.908 17.172-7.74.473-20.439 4.023 18.413 17.819-8.033-35.683 23.305 2.607 3.772 30.419 2.269 11.961-10.561-8.211 9.774 15.644 11.809-19.3-8.5-25.871 1.931 4.707 6.814 10.194 7.216 35.917 3.092 29.584-25.506-12.372 13.07 32.678 4.152c.321-.356.642-.714.956-1.078 1.701-2.035 3.327-4.175 4.711-6.457 2.841-4.508 4.892-9.445 6.012-14.164 1.146-4.714 1.345-9.229.826-12.805a20.635 20.635 0 00-1.081-4.482 380.65 380.65 0 00-1.894-3.569c-.257-.346-.364-.481-.845-.967-.462-.464-.705-.712-.705-.712l.423-.376c-17.73-32.288-41.024-61.849-69.971-88.877m-16.785 269.65l-2.466-.987.565-2.423 3.164 1.266-1.263 2.144zm-2.528 4.29l-1.063-.425.562-2.424 1.764.702-1.263 2.147zm-1.915 3.246l.288-1.249.363.144-.651 1.105zm-23.567 6.555l-2.678-2.683 1.608-1.871 2.94 2.946-1.87 1.608zm-3.752 3.205l-2.144-2.145 1.609-1.872 2.413 2.416-1.878 1.601zm-3.748 3.211l-1.612-1.614 1.608-1.872 1.878 1.883-1.874 1.603zm-3.748 3.21l-1.08-1.082 1.608-1.871 1.346 1.348-1.874 1.605zm-3.749 3.207l-.545-.546 1.605-1.872.814.815-1.874 1.603zm-3.748 3.21l-.016-.013 1.608-1.872.282.283-1.874 1.602zm171.56-53.339c-2.378 3.646-5.258 7.191-8.413 10.648-6.333 6.909-14.098 13.16-22.398 18.396-4.15 2.626-8.447 4.986-12.754 7.117-2.145 1.085-4.339 2.014-6.468 3.011-2.174.891-4.307 1.805-6.431 2.627a197.034 197.034 0 01-12.409 4.255c-2.001.572-3.944 1.133-5.828 1.675l-5.489 1.372a230.553 230.553 0 01-17.17 3.373c-4.172.606-6.556.95-6.556.95l6.479-1.364c4.11-.922 9.957-2.34 16.841-4.444 1.715-.544 3.497-1.114 5.343-1.706 1.826-.65 3.711-1.327 5.649-2.02a196.15 196.15 0 0011.93-4.959c2.028-.939 4.058-1.965 6.121-2.968 2.017-1.107 4.094-2.15 6.107-3.339 4.051-2.334 8.057-4.878 11.878-7.655 7.647-5.538 14.615-11.945 20.069-18.723 2.717-3.394 5.149-6.81 7.078-10.234 1.947-3.412 3.496-6.76 4.659-9.913a53.975 53.975 0 002.282-8.739c.338-2.619.543-4.893.423-6.721.004-.949-.095-1.671-.166-2.296-.029-.317-.058-.608-.081-.876a85.532 85.532 0 01-.174-.921l-.325-1.698.925-.146c-4.698-36.101-14.136-69.646-28.378-100.797a46.262 46.262 0 01-1.079 3.388c-1.892 5.28-4.8 10.491-8.43 15.052-1.778 2.309-3.782 4.419-5.833 6.38-2.083 1.93-4.212 3.73-6.415 5.261-4.36 3.13-8.783 5.44-12.674 7.091-1.922.883-3.776 1.465-5.369 2.077-1.638.497-3.048.967-4.231 1.291-2.368.6-3.72.946-3.72.946l3.585-1.349c1.132-.447 2.477-1.068 4.028-1.733 1.503-.776 3.247-1.541 5.025-2.611 3.606-2.024 7.618-4.725 11.409-8.142 1.441-1.257 2.819-2.646 4.149-4.108l-36.073-.593-9.387 9.914 32.525 22.331-37.192-19.58.05-.079-25.153.027 13.533 9.579 32.606 12.876-34.128-9.353-.092-.025-.303-.161-4.132-2.158 5.135 28.227-10.398-30.976-20.109-10.508-.059 26.625 25.664 23.202 42.255 2.315 20.665-27.191-15.08 27.496 32.07 1.759-33.145.201-.421.77 12.417 16.278-19.178-17.005-37.707.229 3.026 18.525-7.914-19.423-22.672-17.941-.024 10.273 29.447 33.984 38.677 8.274 27.269-11.334-21.799 12.504 24.67 5.279-63.952-9.11 19.084 22.023 31.566 16.595-29.08-12.767 7.399 30.51-13.18-34.086-50.123-51.47-.092 41.006 31.813 36.251-13.926-11.853-.017.027-3.868-1.543.347-1.496-16.682-14.197-6.258 27.185 11.619 21.229-11.249-16.607-.703.599-3.209-3.214 1.198-1.391-.082-.12 1.864-26.349-22.993 20.29 23.352-29.71-1.933-59.676-6.085 5.834-.604.576-.23.037-13.118 23.717 7.84-22.875-26.541 4.237 29.738-9.058 8.722-11.026-1.05-32.406-15.827-18.664-14.45 10.696-.681.506-.202-.024-7.102 21.987 2.591-22.489-19.172-2.139 22.597-.977 12.283-12.438-39.477-46.553c-4.615 62.85-4.987 146.359 10.562 190.73 15.272 43.58 34.358 46.568 72.382 52.52 21.224 3.322 47.639 7.457 80.95 20.163 3.466 1.324 7.053 2.993 10.523 4.605 7.492 3.486 15.239 7.09 21.481 7.09 4.013 0 16.222 0 19.148-42.63 1.466-21.357 1.611-41.958.427-61.831a76.813 76.813 0 01-3.832 6.497M199.021 195.991l32.601-38.442c1.079 16.437 1.848 34.05 2.117 51.852l-22.436-.969-12.282-12.441zm-95.714-61.101l.137.248-1.142.473 1.005-.721zm4.437-3.173l.74 1.336-2.519 1.042-.439-.79 2.218-1.588zm4.435-3.173l1.345 2.425-2.521 1.043-1.041-1.881 2.217-1.587zm4.437-3.171l1.948 3.512-2.52 1.041-1.647-2.966 2.219-1.587zm40.351-36.643l3.677.395-.033 2.61-4.166-.45.522-2.555zm1.051-5.114l2.691.29-.033 2.609-3.184-.344.526-2.555zm1.048-5.114l1.707.184-.03 2.61-2.201-.238.524-2.556zm1.048-5.115l.724.078-.032 2.611-1.217-.131.525-2.558zm.772-3.767l-.015 1.236-.233-.026.248-1.21zm-7.591 275.29l.537 2.128-3.441 1.287-.993-1.956 3.897-1.459zm1.611 6.38l-2.531.945-.993-1.954 2.987-1.119.537 2.128zm1.074 4.251l-1.624.607-.991-1.956 2.078-.775.537 2.124zm1.07 4.256l-.709.265-.993-1.956 1.167-.437.535 2.128zm.539 2.124l.302 1.203-.558-1.106.256-.097zm22.299-3.462l1.576 1.921-2.61 2.614-1.923-1.574 2.957-2.961zm4.726 5.766l-1.91 1.913-1.925-1.572 2.26-2.263 1.575 1.922zm1.577 1.919l1.577 1.922-1.218 1.217-1.923-1.572 1.564-1.567zm3.152 3.844l1.578 1.919-.521.524-1.924-1.572.867-.871zm3.154 3.841l.783.955-.957-.781.174-.174zm-44.384 18.862c38.024-5.952 57.111-8.94 72.379-52.52 10.926-31.172 13.989-81.669 13.248-130.744l-19.014 2.123 2.593 22.487-7.103-21.986-.202.023-.681-.506-14.449-10.699-15.83 18.667-1.049 32.405 8.721 11.026 29.745 9.059-26.544-4.237 7.84 22.875-13.119-23.717-.229-.037-.602-.576-6.089-5.835-1.931 59.681 23.351 29.706-22.993-20.29 1.828 25.853.038.496-.091.131.38.464-2.163 2.166-12.178 17.972 11.623-21.23-6.258-27.186-16.66 14.182.085.338-.863.322-16.71 14.222L167 321.075l-.092-40.812-52.457 55.435-13.211 34.166 7.403-30.514-29.084 12.771 31.562-16.598 24.508-28.931-74.096 15.162 23.669-6.325-24.965-11.761 30.191 10.363 50.286-13.442 26.172-30.896-.023-10.299-22.674 17.94-7.912 19.424 3.022-18.498-51.442.207-19.642 17.415 13.269-17.386-34.417.14 33.635-1.879-15.315-27.924 20.983 27.609 54.806-3.059 25.667-23.206-.062-26.623-20.107 10.509-10.397 30.975 5.136-28.227-4.134 2.158-.304.161-.091.025-34.131 9.353 32.609-12.873 13.534-9.582-25.153-.027.051.079-37.197 19.58 32.528-22.331-9.387-9.914-40.142.66 36.389-4.625-12.371-13.07 29.583 25.506 35.916-3.092 10.194-7.216 4.706-6.814-25.867-1.931-19.302 8.5 15.641-11.809-8.208-9.774 11.961 10.561 30.419-2.269 2.607-3.772-35.681-23.305 17.816 8.033 4.023-18.413.477 20.44 17.166 7.739 24.808-35.908c-.425-.032-.851-.063-1.299-.098-2.513-.055-5.368-.153-8.496-.17-3.143.08-6.541.03-10.161.225-3.616.157-7.433.307-11.387.607-3.955.236-8.043.583-12.197.95-3.147.25-6.332.588-9.522.917a4848.837 4848.837 0 01-21.212 10.493l-1.147.58-.632 18.551-3.753-16.336c-8.006 4.047-14.773 7.465-14.773 7.465l18.099-12.897 8.957-6.217c-12.874 1.59-25.159 3.419-34.891 5.07a464.835 464.835 0 00-15.151 2.827c-3.633.81-5.711 1.271-5.711 1.271l5.611-1.682a458.554 458.554 0 0114.939-3.92 733.986 733.986 0 0116.993-3.936l-34.353-14.384 41.622 12.818a802.227 802.227 0 0121.628-4.258c4.21-.717 8.404-1.519 12.569-2.154 1.108-.179 2.199-.349 3.298-.522l-17.072-15.846-29.413-5.059-.261-.043-.114-.095.183.331-1.144.472-1.618-2.917-11.397-9.338 11.45 7.71.322-.231.394.714 2.575 1.732 27.908 2.136 3.406-19.28-12.622-11.328 15.213 9.519.6.376.01.984.221 22.897 20.571 15.902c2.96-.437 5.835-.783 8.637-1.111l-11.923-36.132-40.739-29.907L159.223 94.2l1.355.145-.009.638 14.881 8.664 13.623-20.925-8.314-25.375 11.273 20.831 8.674-13.324-5.864-20.366 10.303 18.551 8.349-2.467-11.353 4.881-21.466 43.515 16.044 35.473-.471.183c1.2-.102 2.382-.198 3.517-.309 3.249-.216 6.248-.335 8.914-.463 2.795.02 5.23.037 7.236.053l.151.012 12.914-18.694c-2.642-26.748-5.887-46.979-8.477-54.23-6.312-17.677-12.752-32.308-27.677-32.308-10.483 0-24.528 7.045-41.747 20.94-43.064 34.75-75.772 74.038-98.345 118.329-.069.378-.132.766-.181 1.169-.522 3.576-.321 8.091.824 12.805 1.12 4.719 3.171 9.656 6.012 14.164 1.385 2.282 3.011 4.422 4.713 6.456 1.734 2.003 3.542 3.917 5.464 5.593 3.791 3.417 7.801 6.118 11.407 8.142 1.779 1.07 3.524 1.835 5.027 2.611 1.549.665 2.896 1.286 4.027 1.733 2.281.859 3.587 1.349 3.587 1.349s-1.354-.346-3.723-.946c-1.181-.324-2.591-.794-4.23-1.291-1.593-.612-3.448-1.194-5.367-2.077-3.891-1.651-8.315-3.961-12.675-7.091-2.203-1.531-4.331-3.331-6.416-5.261-2.051-1.961-4.053-4.072-5.834-6.38-3.629-4.561-6.536-9.772-8.429-15.052a48.836 48.836 0 01-.762-2.293c-13.978 30.877-23.263 64.098-27.902 99.827l.131.021-.324 1.698-.057.302c-.103.841-.209 1.682-.308 2.525a13.98 13.98 0 00-.056 1.267c-.121 1.827.083 4.102.423 6.72a53.677 53.677 0 002.283 8.739c1.163 3.153 2.713 6.501 4.656 9.913 1.929 3.424 4.363 6.84 7.079 10.234 5.456 6.779 12.422 13.185 20.068 18.723 3.823 2.777 7.828 5.321 11.878 7.655 2.016 1.189 4.094 2.232 6.108 3.339 2.065 1.003 4.095 2.029 6.123 2.968a196.927 196.927 0 0011.929 4.959c1.939.693 3.823 1.37 5.647 2.02 1.847.592 3.634 1.162 5.347 1.706a228.79 228.79 0 0016.841 4.444l6.478 1.364s-2.386-.344-6.558-.95a230.528 230.528 0 01-17.167-3.373l-5.492-1.372c-1.881-.542-3.826-1.103-5.826-1.675a197.913 197.913 0 01-12.409-4.255c-2.125-.822-4.258-1.733-6.433-2.627-2.127-.994-4.322-1.926-6.466-3.011-4.309-2.131-8.604-4.491-12.755-7.114-8.3-5.239-16.067-11.49-22.398-18.396-3.154-3.46-6.036-7.005-8.413-10.651a77.864 77.864 0 01-3.101-5.125c-1.095 19.449-.929 39.593.504 60.459 2.927 42.627 15.137 42.63 19.151 42.63h.001c6.244 0 13.987-3.604 21.479-7.09 3.468-1.612 7.055-3.281 10.522-4.605 33.31-12.706 59.726-16.841 80.952-20.163"
					/>
				</clipPath>
				<rect
					:fill="pctToColor(1 - vq[i] / vqMax)"
					:width="width / 2"
					:height="(height - topMargin) / (vq.length / 2)"
					clip-path="url(#cut-off)"
					v-for="i in Array(vq.length / 2)
						.fill(0)
						.map((_, i) => i)"
					:key="i"
					:y="((height - topMargin) / (vq.length / 2)) * i + topMargin"
				/>
				<rect
					:fill="pctToColor(1 - vq[i + 10] / vqMax)"
					:width="width / 2"
					:height="(height - topMargin) / (vq.length / 2)"
					clip-path="url(#cut-off)"
					v-for="i in Array(vq.length / 2)
						.fill(0)
						.map((_, i) => i)"
					:key="i + 10"
					:x="width / 2"
					:y="((height - topMargin) / (vq.length / 2)) * i + topMargin"
				/>
				<image xlink:href="img/lungs_clear.svg" width="526" height="440" :transform="'scale(' + width / 526 + ', ' + height / 440 + ')'" />
				<g
					v-for="i in Array(vq.length / 2)
						.fill(0)
						.map((_, i) => i)"
					:key="i + '-label'"
					:transform="'translate(' + (-35 * width) / 500 + ', ' + (((height - topMargin) / (vq.length / 2)) * i + (height - topMargin) / vq.length + topMargin / 2) + ') scale(' + width / 500 + ', ' + height / 400 + ')'"
				>
					<rect fill="white" width="30" height="25" rx="5" ry="5" stroke="black" />
					<svg width="30" height="25">
						<text style="font-weight: bold;" dominant-baseline="middle" text-anchor="middle" x="50%" y="50%">
							{{ vq[i].toFixed(1) }}
						</text>
					</svg>
				</g>
				<g
					v-for="i in Array(vq.length / 2)
						.fill(0)
						.map((_, i) => i)"
					:key="i + 10 + '-label'"
					:transform="'translate(' + (width + 5) + ', ' + (((height - topMargin) / (vq.length / 2)) * i + (height - topMargin) / vq.length + topMargin / 2) + ') scale(' + width / 500 + ', ' + height / 400 + ')'"
				>
					<rect fill="white" width="30" height="25" rx="5" ry="5" stroke="black" />
					<svg width="30" height="25">
						<text style="font-weight: bold;" dominant-baseline="middle" text-anchor="middle" x="50%" y="50%">
							{{ vq[i + 10].toFixed(1) }}
						</text>
					</svg>
				</g>
			</g>
		</svg>
	</div>
</template>
<script lang="ts">
import Vue from "vue";
export default Vue.extend({
	props: {
		vq: Array,
		width: Number,
		height: Number,
	},
	computed: {
		xMargin() {
			return 40 * (this.width / 500);
		},
		topMargin() {
			return 30 * (this.height / 400);
		},
		vqMax() {
			const maxVQ = Math.max(...(this.vq as number[]));
			return Math.max(10, maxVQ);
		},
	},
	methods: {
		pctToColor(percentage: number, maxHue = 120, minHue = 0) {
			const hue = percentage * (maxHue - minHue) + minHue;
			return `hsl(${hue}, 100%, 35%)`;
		},
	},
});
</script>
